# Contract: Widget Registration Payload (v1)

```ts
export interface WidgetRegistration {
  widgetId: string;                 // generated by core when placing widget
  moduleId: string;
  serviceId: string;
  title: string;
  layout: WidgetLayout;
  settings: Record<string, unknown>;
  enabled: boolean;
}

export interface WidgetLayout {
  gridCellSize: 'small' | 'medium' | 'large';
  position: GridPosition;          // 0-based row/column
  span: GridSpan;                  // width/height in cells
}

export interface GridPosition {
  row: number;                     // >= 0
  column: number;                  // >= 0
}

export interface GridSpan {
  width: number;                   // >= 1
  height: number;                  // >= 1
}
```

## Server ←→ Renderer IPC
- `ipcMain.handle('widgets:list')` → `WidgetRegistration[]`
- `ipcMain.handle('widgets:save')` ← `WidgetRegistration` (validates bounds)
- `ipcMain.handle('widgets:remove')` ← `{ widgetId: string }`

## Validation & Constraints
- Placering måste respektera rutnätets gränser beroende på `gridCellSize` (upplösning definieras i DeviceProfile).
- Drag/resize i inställningsläge triggar `widgets:save` som automatiskt korrigerar utanför-gräns-fall enligt FR-015.
- Widgets kan endast skapas för moduler och tjänster som är aktiverade.

## Error Codes
- `WIDGET_INVALID_SIZE` — span utanför min/max.
- `WIDGET_OUT_OF_BOUNDS` — position+span går utanför rutnätet efter autojustering.
- `WIDGET_MODULE_INACTIVE` — modul ej aktiverad.
